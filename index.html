<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Envie dados para a Planilha do Google</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <form id="form">
    <label for="input">Digite o texto:</label>
    <input type="text" id="input" name="input">
    <button type="submit">Enviar</button>
  </form>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      var form = document.getElementById("form");
      form.addEventListener("submit", function(event) {
        event.preventDefault();
        gapi.load("client:auth2", function() {
          gapi.client.init({
            apiKey: "AIzaSyDbNiBBtTSzv5csaTMEJ-HKADstm4NpxmQ",
            clientId: "772377516775-6ej6g7ff3qp4n8ljb94ukt3834qd0hi9.apps.googleusercontent.com",
            discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
            scope: "https://www.googleapis.com/auth/spreadsheets"
          }).then(function() {
            var input = document.getElementById("input").value;
            var spreadsheetId = "1_khL1gjUifjGXxJMs2hR0wBbW7zGmENlYUN8-w20tPE";
            var range = "Sheet1!A1";
            gapi.client.sheets.spreadsheets.values.update({
              spreadsheetId: spreadsheetId,
              range: range,
              valueInputOption: "RAW",
              resource: {
                values: [[input]]
              }
            }).then(function(response) {
              console.log(response);
              alert("Dados enviados com sucesso!");
            }, function(reason) {
              console.error(reason);
              alert("Erro ao enviar dados.");
            });
          });
        });
      });
    });
  </script>
</body>
</html>
